<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Lluvia de Amor</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: black;
    }
    canvas {
        display: block;
    }
</style>
</head>
<body>
<canvas id="canvas"></canvas>

<script>
// Pide el nombre al abrir la p√°gina
let destinatario = prompt("Esta carta es para:");  // üëà NUEVO

if (!destinatario) destinatario = "Mi amor";  // si no escribe nada

function drawMessage() {
    ctx.fillStyle = "black";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = "#ff3366";
    ctx.font = "48px monospace";
    ctx.textAlign = "center";
    ctx.fillText("Te amo " + destinatario, canvas.width / 2, canvas.height / 2 - 30);
    ctx.fillText("y siempre te voy a amar ‚ù§Ô∏è", canvas.width / 2, canvas.height / 2 + 30);
}
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const mensaje = "Te amo";
const fontSize = 28;
const columns = Math.floor(canvas.width / fontSize);

const drops = [];
for (let i = 0; i < columns; i++) {
    drops[i] = {
        y: Math.random() * canvas.height,
        speed: 1 + Math.random() * 2
    };
}

let stage = 0;
let heartParticles = [];
let showMessage = false;

function createHeartParticles() {
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;

    for (let i = 0; i < 500; i++) {
        const t = Math.random() * Math.PI * 2;  // üëà CORRECTO
        const r = 20 + Math.random() * 10;

        const x = centerX + 16 * Math.pow(Math.sin(t), 3) * r;
        const y = centerY - (
            13 * Math.cos(t) -
            5 * Math.cos(2 * t) -
            2 * Math.cos(3 * t) -
            Math.cos(4 * t)
        ) * r;

        heartParticles.push({
            x: centerX,
            y: centerY,
            vx: (x - centerX) * 0.015,
            vy: (y - centerY) * 0.015,
            alpha: 1
        });
    }
}

function drawHeartParticles() {
    ctx.fillStyle = "rgba(0,0,0,0.2)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    for (let i = 0; i < heartParticles.length; i++) {
        const p = heartParticles[i];
        ctx.fillStyle = `rgba(255,105,180,${p.alpha})`;
        ctx.beginPath();
        ctx.arc(p.x, p.y, 4, 0, Math.PI * 2);
        ctx.fill();

        p.x += p.vx;
        p.y += p.vy;
        p.alpha -= 0.005;
    }

    heartParticles = heartParticles.filter(p => p.alpha > 0);

    if (heartParticles.length === 0 && !showMessage) {
        stage = 3;
        showMessage = true;
    }
}

function drawMessage() {
    ctx.fillStyle = "black";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = "#ff3366";
    ctx.font = "48px monospace";
    ctx.textAlign = "center";
    ctx.fillText("Te amo " + destinatario, canvas.width / 2, canvas.height / 2 - 30);
    ctx.fillText("y siempre te voy a amar ‚ù§Ô∏è", canvas.width / 2, canvas.height / 2 + 30);
}
function draw() {
    if (stage === 0) {
        ctx.fillStyle = "rgba(0, 0, 0, 0.4)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.fillStyle = "#ff3366";
        ctx.font = fontSize + "px monospace";

        for (let i = 0; i < drops.length; i++) {
            ctx.fillText(mensaje, i * fontSize, drops[i].y);
            drops[i].y += drops[i].speed * fontSize * 0.08;

            if (drops[i].y > canvas.height && Math.random() > 0.001) {
                drops[i].y = -fontSize;
                drops[i].speed = 1 + Math.random() * 2;
            }
        }

    } else if (stage === 1) {
        ctx.fillStyle = "black";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

    } else if (stage === 2) {
        drawHeartParticles();

    } else if (stage === 3) {
        drawMessage();
    }
}

// Cambios de etapa
setTimeout(() => { stage = 1; }, 8000);
setTimeout(() => {
    stage = 2;
    createHeartParticles();
}, 9000);

setInterval(draw, 30);

</script>
</body>
</html>
 